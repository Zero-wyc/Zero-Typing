var k=Object.defineProperty;var R=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var w=(a,n,s)=>n in a?k(a,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[n]=s,y=(a,n)=>{for(var s in n||(n={}))M.call(n,s)&&w(a,s,n[s]);if(R)for(var s of R(n))L.call(n,s)&&w(a,s,n[s]);return a};import{r as c,Y as d,V as t,a7 as m,X as P,Z as N,a0 as j,a8 as K}from"./index.0058dadb.js";import{w as D}from"./wordTool.9a5cf8b9.js";import{R as I,T as V}from"./ReloadBtn.a0f6c0e5.js";import{S as X}from"./index.733906b1.js";const z=32,G=13,O=/^[^\x00-\xff]+$/,U=()=>K(()=>import("./sentences.fca53ad5.js"),[]),J=()=>{const[a,n]=c.exports.useState(!0),s=c.exports.useRef(null),f=c.exports.useRef([]),[o,A]=c.exports.useState([]),[i,S]=c.exports.useState(0),[C,T]=c.exports.useState(5),[v,E]=c.exports.useState(""),[b,B]=c.exports.useState(!1),[g,F]=c.exports.useState(!1),r=c.exports.useRef({cpm:"",right:0,wrong:0,acc:0,time:{begin:0,secs:0}}),_=e=>{e===" "||g||(E(e),O.test(e)&&A(u=>{const l=[...u],h=y({},l[i]);for(let p=0;p<e.length;p++)h.charArr[p]&&(h.charArr[p].isCorrect=e.charAt(p)===h.charArr[p].char);return l.splice(i,1,h),l}))},$=e=>{if(!g&&(r.current.time.begin===0&&(r.current.time.begin=Date.now()),(e.keyCode===G||e.keyCode===z)&&v.length>=o[i].sentence.length))if(i===o.length-1){const u=o.reduce((l,h)=>[...l,...h.charArr],[]);r.current.right=u.filter(l=>l.isCorrect).length,r.current.wrong=u.length-r.current.right,r.current.acc=Math.round(r.current.right/(r.current.right+r.current.wrong)*100),r.current.time.secs=Math.round((Date.now()-r.current.time.begin)/1e3),r.current.cpm=(r.current.right/(r.current.time.secs/60)).toFixed(2),B(!0),setTimeout(()=>{F(!0)},150)}else S(u=>u+1),E("")},x=c.exports.useCallback(()=>{E(""),S(0),r.current={cpm:"",right:0,wrong:0,acc:0,time:{begin:0,secs:0}},f.current=D.shuffle(f.current),A(D.jsonCopy(f.current.slice(0,C)).map(e=>({sentence:e,charArr:Array.from(e).map(u=>({char:u,isCorrect:null}))}))),B(!1),F(!1),setTimeout(()=>{s.current.focus()},10)},[C]);return c.exports.useEffect(()=>{n(!0),U().then(e=>{f.current=e.default,x(),n(!1)})},[x]),d("div",{className:"Sentence",children:[t("div",{className:"word-count-radio",children:d(m.Group,{value:C,size:"small",onChange:e=>{T(e.target.value)},children:[t(m.Button,{tabIndex:-1,value:5,children:"5"}),t(m.Button,{tabIndex:-1,value:10,children:"10"}),t(m.Button,{tabIndex:-1,value:15,children:"15"}),t(m.Button,{tabIndex:-1,value:20,children:"20"})]})}),d(P,{justify:"center",align:"middle",children:[d(N,{flex:"900px",className:`type-main-box ${b?"fading":""} ${g?"hide":""}`,children:[t("div",{className:"sentence-line",children:o[i]&&o[i].charArr.map((e,u)=>t("code",{className:`char ${e.isCorrect?"correct":e.isCorrect===!1?"wrong":""}`,children:e.char},u))}),t(X,{spinning:a,tip:"\u52A0\u8F7D\u4E2D",className:"sentence-loading",children:t("div",{})}),t("div",{className:"sentence-input",children:t(j,{ref:s,value:v,onChange:e=>_(e.target.value),onKeyDown:$})}),t("div",{className:"sentence-next",children:o[i+1]&&o[i+1].sentence}),t("div",{className:"reload-line",children:t(I,{onClick:x})}),d("div",{className:"tip-line",children:[t("div",{children:"\u70B9\u51FB\u6A2A\u7EBF\u4E0A\u65B9\u8FDB\u5165\u8F93\u5165\u72B6\u6001"}),t("div",{children:"\u8F93\u5165\u6B63\u786E\u4E2D\u6587\u548C\u7B26\u53F7\uFF0C\u7136\u540E\u7A7A\u683C\u6216\u56DE\u8F66"}),d("div",{children:["\u8F93\u5165\u72B6\u6001\u4E0B",t("code",{children:"Tab"}),"\u540E\u56DE\u8F66\u53EF\u4EE5\u76F4\u63A5\u5237\u65B0"]})]})]}),d(N,{flex:"900px",className:`type-result-box ${g?"show":""}`,children:[t(V,{desc:"\u5B57/\u5206\u949F",numStr:r.current.cpm,acc:r.current.acc,secs:r.current.time.secs}),t("div",{className:"reload-line",children:t(I,{onClick:x})})]})]})]})};export{J as default};
